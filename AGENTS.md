# AGENTS.md

## Project overview
- This is a Next.js 14 App Router experience that renders a typed, interactive product-matching flow in `app/page.tsx` and delegates scoring logic to the shared engine in `lib/engine.js`.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=176 path=app/page.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/page.tsx#L1-L176"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=233 path=lib/engine.js git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/lib/engine.js#L1-L233"}​
- The root layout wires up Geist fonts and global styles—keep those integrations intact when touching the shell.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=26 path=app/layout.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/layout.tsx#L1-L26"}​
- Matching behavior is consumed by both the UI and the Node-based test suite, so changes to the engine or data contracts must be reflected in the TypeScript definitions and tests alongside the implementation.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=324 path=lib/engine.js git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/lib/engine.js#L1-L324"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=42 path=lib/types.ts git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/lib/types.ts#L1-L42"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=50 path=tests/engine.test.js git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/tests/engine.test.js#L1-L50"}​

## Tooling & verification
- Use the package scripts (`dev`, `build`, `lint`, `test`) to iterate and validate changes; `test` delegates to `node --test` for the headless engine coverage.​:codex-file-citation[codex-file-citation]{line_range_start=5 line_range_end=10 path=package.json git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/package.json#L5-L10"}​
- Because `next.config.mjs` suppresses lint and TypeScript failures during `next build`, always run `lint` and `test` locally (and add `build` when you touch runtime behavior) before sending a PR.​:codex-file-citation[codex-file-citation]{line_range_start=3 line_range_end=11 path=next.config.mjs git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/next.config.mjs#L3-L11"}​​:codex-file-citation[codex-file-citation]{line_range_start=5 line_range_end=10 path=package.json git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/package.json#L5-L10"}​
- Follow the fixture-driven pattern in `tests/engine.test.js` when writing new scenarios so the suite stays deterministic and easy to reason about.​:codex-file-citation[codex-file-citation]{line_range_start=6 line_range_end=45 path=tests/engine.test.js git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/tests/engine.test.js#L6-L45"}​

## Directory guide
- `app/` holds the App Router entry points. Keep stateful components marked with `'use client'`, preserve the grid/carousel toggle, summary copy, and weight sliders in `page.tsx`, and leave the loading boundary minimal unless a new UX is required.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=600 path=app/page.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/page.tsx#L1-L600"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=26 path=app/layout.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/layout.tsx#L1-L26"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=3 path=app/loading.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/loading.tsx#L1-L3"}​
- `app/globals.css` (mirrored in `styles/globals.css`) defines tailwind design tokens and dark-mode variants. Update both files together whenever you adjust the design system primitives.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=125 path=app/globals.css git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/globals.css#L1-L125"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=125 path=styles/globals.css git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/styles/globals.css#L1-L125"}​
- `components/` provides reusable building blocks. Keep shadcn primitives inside `components/ui/` aligned with their existing `cva` variants and the `cn` utility, and place higher-level wrappers (such as `theme-provider`) alongside them in the folder root.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=59 path=components/ui/button.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/components/ui/button.tsx#L1-L59"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=11 path=components/theme-provider.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/components/theme-provider.tsx#L1-L11"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=5 path=lib/utils.ts git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/lib/utils.ts#L1-L5"}​
- `hooks/` exposes client-only utilities like `useIsMobile` and the toast reducer. Mirror their patterns (event listeners within `useEffect`, reducer-driven state machines) when introducing new hooks.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=19 path=hooks/use-mobile.ts git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/hooks/use-mobile.ts#L1-L19"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=191 path=hooks/use-toast.ts git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/hooks/use-toast.ts#L1-L191"}​
- `lib/` contains framework-agnostic code. Keep `engine.js` pure and JavaScript-based for Node compatibility, extend `types.ts` when data shapes evolve, and share helpers like `cn` from here.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=324 path=lib/engine.js git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/lib/engine.js#L1-L324"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=42 path=lib/types.ts git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/lib/types.ts#L1-L42"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=5 path=lib/utils.ts git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/lib/utils.ts#L1-L5"}​
- `tests/` currently focuses on the engine; expand it whenever ranking, parsing, or summarization logic changes so UI expectations remain covered.​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=50 path=tests/engine.test.js git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/tests/engine.test.js#L1-L50"}​
- Module aliases (`@/components`, `@/hooks`, `@/lib`, etc.) are defined in `components.json`; keep new code within these directories so imports stay consistent.​:codex-file-citation[codex-file-citation]{line_range_start=13 line_range_end=18 path=components.json git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/components.json#L13-L18"}​

## Coding conventions
- Default to TypeScript for app code, leaning on explicit generics and shared types when managing component state, as demonstrated in `page.tsx` and `lib/types.ts`.​:codex-file-citation[codex-file-citation]{line_range_start=148 line_range_end=246 path=app/page.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/page.tsx#L148-L246"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=42 path=lib/types.ts git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/lib/types.ts#L1-L42"}​
- Follow the Tailwind-first styling approach used throughout `page.tsx`, combining shadcn components with utility classes and merging conditional styles via `cn`.​:codex-file-citation[codex-file-citation]{line_range_start=247 line_range_end=573 path=app/page.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/page.tsx#L247-L573"}​​:codex-file-citation[codex-file-citation]{line_range_start=7 line_range_end=54 path=components/ui/button.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/components/ui/button.tsx#L7-L54"}​​:codex-file-citation[codex-file-citation]{line_range_start=1 line_range_end=5 path=lib/utils.ts git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/lib/utils.ts#L1-L5"}​
- When extending the UI (e.g., adding new filters or result views), make sure both the grid and carousel flows remain synchronized with weights, summaries, and pagination state.​:codex-file-citation[codex-file-citation]{line_range_start=202 line_range_end=573 path=app/page.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/page.tsx#L202-L573"}​
- Reuse the toast reducer and action set provided in `use-toast.ts` rather than introducing global singletons or duplicate logic; the hook already manages lifetimes and limits for you.​:codex-file-citation[codex-file-citation]{line_range_start=18 line_range_end=191 path=hooks/use-toast.ts git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/hooks/use-toast.ts#L18-L191"}​
- Keep business rules inside `lib/engine.js`, augmenting its test suite whenever you add criteria or change scoring explanations so UI consumers can stay thin.​:codex-file-citation[codex-file-citation]{line_range_start=61 line_range_end=224 path=lib/engine.js git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/lib/engine.js#L61-L224"}​​:codex-file-citation[codex-file-citation]{line_range_start=12 line_range_end=50 path=tests/engine.test.js git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/tests/engine.test.js#L12-L50"}​
- Preserve accessibility affordances (aria rings, semantic headings, button slots) already present in the shadcn components and result markup.​:codex-file-citation[codex-file-citation]{line_range_start=7 line_range_end=54 path=components/ui/button.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/components/ui/button.tsx#L7-L54"}​​:codex-file-citation[codex-file-citation]{line_range_start=247 line_range_end=599 path=app/page.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/page.tsx#L247-L599"}​

## Review checklist
- Ensure `lint` and `test` pass via the package scripts before requesting review; call out any intentionally skipped checks in your PR description.​:codex-file-citation[codex-file-citation]{line_range_start=5 line_range_end=10 path=package.json git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/package.json#L5-L10"}​
- Manually smoke-test both the grid and carousel result views, including weight sliders, summary copy, and expandable score details, after engine or UI changes.​:codex-file-citation[codex-file-citation]{line_range_start=202 line_range_end=573 path=app/page.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/page.tsx#L202-L573"}​
- Keep the mock catalog, summary narratives, and any supporting assets in sync so product imagery and copy remain coherent when results change.​:codex-file-citation[codex-file-citation]{line_range_start=31 line_range_end=176 path=app/page.tsx git_url="https://github.com/benjaminshoemaker/product_shopping_helper/blob/main/app/page.tsx#L31-L176"}​
